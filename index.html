<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
   
    <title>Working place</title>
    <meta http-equiv="Content-Type" content="text/html">
    <link rel="stylesheet" href="main.css">
    <script src="bower_components/webcomponentsjs/webcomponents.js"></script>
    <script src="bower_components/webcomponentsjs/HTMLImports.js"></script>
    <script src="bower_components/webcomponentsjs/MutationObserver.js"></script>
    <link rel="import" href="elements.html">
    <link href="https://fonts.googleapis.com/css?family=Noto+Sans:700" rel="stylesheet">
    <link rel="import" href="styles/app-theme.html">
    <style is="custom-style" include="shared-styles"></style>
</head>
<body>
    <template is="dom-bind" id="app">
       <paper-drawer-panel id="paperDrawerPanel">
        <paper-scroll-header-panel drawer fixed>
            
            <!-- Drawer Toolbar -->
            <paper-toolbar id="drawerToolbar">
                <iron-icon src="images/nis1.jpg" ></iron-icon>
                <span class="nameMenu">Menu</span>
            </paper-toolbar>
            
             <!-- Drawer Content -->
            <paper-menu class="app-menu" attr-for-selected="data-route" selected="[[route]]">

                <a data-route="home" href="{{baseUrl}}">
                    <iron-icon icon="home" class="menu-icon"></iron-icon>
                    <span>Home</span>
                </a>

                <a data-route="journal" href="{{baseUrl}}journal">
                    <iron-icon icon="social:school" class="menu-icon"></iron-icon>
                    <span>Electronic Journal</span>
                </a>
                
                 <a data-route="make" href="{{baseUrl}}make">
                    <iron-icon src="images/desktop-classic.png" class="menu-icon"></iron-icon>
                    <span>Make working place</span>
                </a>

                <a data-route="add" href="{{baseUrl}}add">
                    <iron-icon icon="add" class="menu-icon"></iron-icon>
                    <span>Add link</span>
                    
                </a>
               
            </paper-menu>
        </paper-scroll-header-panel>
        
        <!-- Main Area -->
        <paper-scroll-header-panel main id="headerPanelMain" condenses keep-condensed-header>
            <paper-toolbar id="mainToolbar" class="tall">
                <paper-icon-button id="paperToggle" icon="menu" paper-drawer-toggle></paper-icon-button>
                
                <!-- Application name -->
                <div class="middle middle-container">
                    <div class="app-name">Working place V0.1</div>
                </div>
                   <div class="bottom bottom-container">
            <div class="bottom-title">Split types</div>
         
            <paper-icon-button src="images/square.png"></paper-icon-button>
            <paper-icon-button icon="view-agenda"></paper-icon-button>
            <paper-icon-button icon="view-agenda" id="two"></paper-icon-button>
            <paper-icon-button src="images/view-parallel.png" id="three"></paper-icon-button>
            <paper-icon-button src="images/view-grid%20.png" id="four"></paper-icon-button>
                </div>
                         
            </paper-toolbar>
            
            <!-- Main Content -->
            <div class="content">
                <iron-pages attr-for-selected="data-route" selected="{{route}}">
                    <section data-route="home" tabindex="-1">
                        
                      <paper-material elevation="1">
                        <h1 class="page-heading">Welcome!</h1>
                        <p>This is prototype of working place for students of Nazabayev Intellectual Schools.</p>
                        <p>On this site you can:</p>
                        <ul>
                          <li>Open school journal</li>      
                          <li>Organize your working place with special split types</li>     
                          <li>Save your own working place locally to use it again</li>
                        </ul>
                      </paper-material>
                        
                    </section>
                    <section data-route="journal" tabindex="-1">
                        <div class="siteContainer">
                            <iframe width="854" height="480" src=""  class="noSplit"></iframe>
                        </div>
                    </section>
                    
                <section data-route="make" tabindex="-1">
                       <paper-material elevation="1">
                        <h1>Make your own working place</h1>
                        <h3>Available links</h3>
                       </paper-material>
                </section>
                    
                    
                    
                    
                    
                <section data-route="add" tabindex="-1">
                      <paper-material elevation="1" id="URL">
                        <h1>Add link</h1>
                        <paper-input placeholder="Enter URL" id="inputUrl"></paper-input>
                        <paper-button class="button" onclick="addUrl()">Add</paper-button>
                        <paper-button class="button" onclick="deleteUrl()">Delete</paper-button>
                       </paper-material>
                        <div id="firstColumn" class="column">  
                        </div>    
                       
                        <div id="secondColumn" class="column">
                        </div>
                        
                        <div id="thirdColumn" class="column">
                        </div>
                </section>
                    
                     
                        
                </iron-pages>
            </div>
            
            
            
            
        
        </paper-scroll-header-panel>
    
    </paper-drawer-panel>
    </template>
            <script src="scripts/app.js"></script>
<script>
          var index=0;
       showUrl(index);
                
            function column(n){
               index++;
               return index;
            }
                 var index1;
            function showUrl(n){
         var db = openDatabase('mydb', '1.0', 'WorkingPlace', 1024);
         var msg;
         db.transaction(function (tx) {
            tx.executeSql('CREATE TABLE IF NOT EXISTS URLS (Url)');
         });
                
         db.transaction(function (tx) {
            tx.executeSql('SELECT * FROM URLS', [], function (tx, results) {
               var len = results.rows.length, i;
               msg='';
             		
               for (i = 0; i < len; i++){
                  msg = "<div class='container'><a href=" + results.rows.item(i).Url + " onclick='newMyWindow(this.href); return false;'><paper-material elevation='1' id='URL1'><h1><b>" + results.rows.item(i).Url + "</b></h1></paper-material></a><paper-icon-button id='black' icon='close' onclick=closethis('" + results.rows.item(i).Url + "')></paper-icon-button></div>";
                index1 = column(n);
                var select;
               if (index1%3==1)
                   {
                       select='#firstColumn';
                   }
                if(index1%3==2)
                    {
                        select='#secondColumn'
                    }
                 if(index1%3==0)
                    {
                        select='#thirdColumn'
                    }
                document.querySelector(select).innerHTML +=  msg;
               }
                
            }, null);
         });
           
       };
                
            function addUrl(){
              var inputUrl = document.getElementById('inputUrl');
               
              var db = openDatabase('mydb', '1.0', 'WorkingPlace', 1024);
             var msg;
             msg='';
         db.transaction(function (tx) {
            tx.executeSql('CREATE TABLE IF NOT EXISTS URLS (Url)');
            tx.executeSql('INSERT INTO URLS (Url) VALUES ("' +inputUrl.value+'")');
         });
                 
         db.transaction(function (tx) {
                  msg = "<div class='container'><a href=" + inputUrl.value + " onclick='newMyWindow(this.href); return false;'><paper-material elevation='1' id='URL1'><h1><b>" + inputUrl.value + "</b></h1></paper-material></a><paper-icon-button id='black' icon='close' onclick=closethis('" + inputUrl.value + "') ></paper-icon-button></div>";
                   var index1;
                 index1 = column(index);
              
                var select;
               if (index1%3==1)
                   {
                       select='#firstColumn';
                   }
                if(index1%3==2)
                    {
                        select='#secondColumn';
                    }
                 if(index1%3==0)
                    {
                        select='#thirdColumn'
                    }
                document.querySelector(select).innerHTML +=  msg;
                
             });  
                var seize = document.getElementById("URL1");
                
            };
            
                
            function deleteUrl(){
         var db = openDatabase('mydb', '1.0', 'WorkingPlace', 2 * 1024 * 1024);
         db.transaction(function (tx) {
            tx.executeSql('DELETE FROM URLS');
             document.querySelector('#firstColumn').innerHTML ='';
             document.querySelector('#secondColumn').innerHTML ='';
             document.querySelector('#thirdColumn').innerHTML ='';
             index = 0;
              });
            };
                
 function newMyWindow(e) {
  window.open(e, '', 'scrollbars=1,height=980,width='+screen.availWidth);
};
    
function closethis(e) {
    var db = openDatabase('mydb', '1.0', 'WorkingPlace', 2 * 1024 * 1024);
    db.transaction(function (tx) {
    tx.executeSql("DELETE FROM URLS WHERE Url='"+e+"'");
    document.querySelector('#firstColumn').innerHTML ='';
    document.querySelector('#secondColumn').innerHTML ='';
    document.querySelector('#thirdColumn').innerHTML ='';
    index = 0;
    showUrl(index);        
              }); 
};
</script>
                
                
           
</body>

    

</html>